"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function getTimeStr(a){var b=Math.floor(a/3600),c=Math.floor(a%3600/60),d=Math.floor(a%60);return b=b>=10?b:"0"+b,c=c>=10?c:"0"+c,d=d>=10?d:"0"+d,"00"===b?c+":"+d:b+":"+c+":"+d}function isFullScreen(){return document.isFullScreen||document.mozIsFullScreen||document.webkitIsFullScreen}function copyright(){console.log("\n %c EPlayer 0.2.10 %c eplayer.js.org \n","color: #fff; background: linear-gradient(to right,#57a1fc ,#6beaf7); padding:5px;","color: #7192c3; background: #ecfaff; padding:5px 0;")}function isSafari(){return/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)}var _createClass,OFFSETDOT,Init,Hls,Eplayer;Object.defineProperty(exports,"__esModule",{value:!0}),_createClass=function(){function a(a,b){var c,d;for(c=0;c<b.length;c++)d=b[c],d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),OFFSETDOT=18,copyright(),Init=function a(b,c){_classCallCheck(this,a);var d='\n    <link rel="stylesheet" href="//at.alicdn.com/t/font_836948_g9ctpaubgfq.css">\n    <style>\n      .player {\n        background:#000;\n        width: 100%;\n        height: 100%;\n        position: relative;\n      }\n      .player video {\n        width: 100%;\n        height: 100%;\n      }\n      .player .panel {\n        position: absolute;\n        top: 50%;\n        left: 50%;\n        transform: translate(-50%,-50%);\n      }\n      .player .wrap {\n        height: 100%;\n        width: 100%;\n      }\n      .player:hover .controls {\n        opacity: 1\n      }\n      .player .panels .epicon {\n        font-size: 80px\n      }\n      .player .controls {\n        width: 100%;\n        position: absolute;\n        bottom: 0;\n        padding: 0 15px;\n        box-sizing: border-box;\n        opacity: 0;\n        transition: .5s ease-out;\n      }\n      .player .option {\n        position: relative;\n        display:flex;\n        align-items: center;\n        padding: 10px 0;\n      }\n      .player .option-left{\n        display: flex;\n        flex: 1;\n        align-items: center;\n      }\n      .player .option-right{\n        display: flex;\n        flex: 1;\n        align-items: center;\n        justify-content: flex-end\n      }\n      .player .progress-bar {\n        width: 100%;\n        position: relative;\n        cursor: pointer;\n      }\n      .player .volume-progress-bar {\n        width: 100px;\n        position: relative;\n        cursor: pointer;\n      }\n      .player .volume-progress {\n        border-radius:2px;\n        height: 4px;\n        background-color: rgba(255, 255, 255, 0.8);\n      }\n      .player .progress {\n        border-radius:2px;\n        height: 4px;\n        background-color: rgba(255, 255, 255, 0.8);\n      }\n      .player .dot {\n        padding: 20px;\n        position: absolute;\n        top: -18px;\n        left: -18px;\n        transition: 0.01s\n      }\n      .player .dot i {\n        height: 13px;\n        width: 13px;\n        background: '+c.themeColor+";\n        position: absolute;\n        border-radius: 50%;\n        top: 50%;\n        left:50%;\n        transform:translate(-50%,-50%)\n      }\n      .player .volume {\n        display: flex;\n        align-items: center;\n        padding-right: 15px;\n      }\n      .player .current-progress {\n        width: 0%;\n        height: 100%;\n        background: "+c.themeColor+";\n        position: absolute;\n        border-radius:2px;\n        top: 0;\n        transition: .1s\n      }\n      .player .buffer {\n        width: 0%;\n        height: 100%;\n        background: "+c.themeColor+';\n        opacity:.4;\n        position: absolute;\n        border-radius:2px;\n        top: 0;\n        transition: .3s;\n      }\n      .player .time {\n        text-align: center;\n        font-size: 12px;\n        color: #fff;\n        padding-left: 15px;\n      }\n      .player .epicon:hover {\n        color: #fff;\n      }\n      .player .epicon {\n        color: rgba(255, 255, 255, 0.8);\n        cursor: pointer;\n        transition: 0.3s;\n        font-size: 20px;\n      }\n      .player .ep-volume-down,.ep-volume-up,.ep-volume-off {\n        padding-right: 15px\n      }\n      .player .loading {\n        position: absolute;\n        top: 50%;\n        left: 50%;\n        margin:-20px 0 0 -20px;\n        width: 40px;\n        height: 40px;\n        border: 4px solid;\n        border-color: rgba(255, 255, 255, 0.8) rgba(255, 255, 255, 0.8) transparent;\n        border-radius: 50%;\n        box-sizing: border-box;\n        animation: loading 1s linear infinite;\n      }\n      @keyframes loading{\n        0%{\n          transform: rotate(0deg);\n        }\n        100%{\n          transform: rotate(360deg);\n        }  \n      }\n      @keyframes display{\n        0%{\n          opacity: 1;\n        }\n        100%{\n          opacity: 0;\n        }\n      }\n    </style>\n    <div class="player">\n      <video src="'+c.src+'" webkit-playsinline playsinline x5-playsinline x-webkit-airplay="allow"></video>\n        <div class="panels">\n          <div class="loading"></div>\n          <i class="epicon ep-play panel" style="display:none;"></i>\n        </div>\n        <div class="controls">\n          <div class="progress-bar">\n            <div class="current-progress"></div>\n            <div class="buffer"></div>\n            <div class="dot">\n              <i></i>\n            </div>\n            <div class="progress"></div>\n          </div>\n          <div class="option">\n            <div class="option-left">\n              <div class="control">\n                <i class="epicon ep-play switch"></i>\n              </div>\n              <div class="time">\n                <span class="current">00:00</span>\n                /\n                <span class="total">00:00</span>\n              </div>\n            </div>\n            <div class="option-right"> \n              <div class="volume">\n                <i class="epicon ep-volume-up volume-button"></i>\n                <div class="volume-progress-bar">\n                  <div class="volume-progress"></div>\n                  <div class="current-progress"></div>\n                  <div class="dot">\n                    <i></i>\n                  </div>\n                </div>\n              </div> \n              <div class="control">\n                <i class="epicon ep-full full"></i>\n              </div>  \n            </div>\n          </div>\n        </div>\n    </div>\n    ';b.innerHTML=d},Hls=function b(a,c){var d,e;_classCallCheck(this,b),this.src=c.src,this.el=a,d=require("hls.js"),d.isSupported()&&(e=new d,e.loadSource(this.src),e.attachMedia(this.el))},Eplayer=function(){function a(b,c){var d=this;_classCallCheck(this,a),this.el=b,this.data=c,this.h=b.clientHeight,this.w=b.clientWidth,new Init(this.el,this.data),this.video=document.querySelector(".player video"),this.loading=document.querySelector(".player .loading"),this.isPlay=document.querySelector(".player .switch"),this.panel=document.querySelector(".player .panel"),this.totalTime=document.querySelector(".player .total"),this.currentTime=document.querySelector(".player .current"),this.dot=document.querySelector(".player .progress-bar .dot"),this.vdot=document.querySelector(".player .volume .dot"),this.full=document.querySelector(".player .full"),this.progress=document.querySelector(".player .progress"),this.currentProgress=document.querySelector(".player .current-progress"),this.currentVolumeProgress=document.querySelector(".player .volume .current-progress"),this.volumeBtn=document.querySelector(".player .volume-button"),this.controls=document.querySelector(".player .controls"),this.buffer=document.querySelector(".player .buffer"),this.volumeProgress=document.querySelector(".player .volume-progress"),-1!==c.src.indexOf("m3u8")&&new Hls(this.video,this.data),isSafari()&&(this.loading.style.display="none",this.panel.style.display="block"),this.tTime=0,this.x=0,this.l=0,this.nl=0,this.nx=0,this.vx=0,this.vl=0,this.vnl=0,this.vnx=0,this.bufferEnd=0,this.isDown=!1,this.video.onwaiting=function(){return d.waiting()},this.video.oncanplay=function(){return d.canplay()},this.isPlay.onclick=function(){return d.play()},this.panel.onclick=function(){return d.play()},this.video.ontimeupdate=function(){return d.timeupdate()},this.progress.onclick=this.currentProgress.onclick=this.buffer.onclick=function(a){return d.progressClick(a)},this.volumeProgress.onclick=this.currentVolumeProgress.onclick=function(a){return d.volumeClick(a)},this.video.onended=function(){return d.ended()},this.full.onclick=function(){return d.fullScreen()},this.dot.onmousedown=function(a){return d.Dotonmousedown(a)},this.dot.onmousemove=function(a){return d.Dotonmousemove(a)},this.dot.onmouseup=function(a){return d.Dotonmouseup(a)},this.vdot.onmousedown=function(a){return d.Volumeonmousedown(a)},this.vdot.onmousemove=function(a){return d.Volumeonmousemove(a)},this.vdot.onmouseup=function(a){return d.Volumeonmouseup(a)},this.volumeBtn.onclick=function(){return d.isVolume()},window.onresize=function(a){return d.windowResize(a)}}return _createClass(a,[{key:"waiting",value:function(){this.loading.style.display="block"}},{key:"canplay",value:function(){var a,b;this.tTime=this.video.duration,this.loading.style.display="none",this.panel.style.display="block",a=getTimeStr(this.tTime),this.totalTime.innerHTML=a,b=this.volumeProgress.clientWidth,this.video.volume=.7,this.currentVolumeProgress.style.width=this.video.volume*b+"px",this.vdot.style.left=this.video.volume*b-OFFSETDOT+"px",this.vl=this.video.volume*b}},{key:"play",value:function(){this.video.paused?(this.video.play(),this.isPlay.classList.remove("ep-play"),this.isPlay.classList.add("ep-pause"),this.panel.classList.remove("ep-play"),this.panel.classList.add("wrap")):(this.video.pause(),this.isPlay.classList.remove("ep-pause"),this.isPlay.classList.add("ep-play"),this.panel.classList.remove("wrap"),this.panel.classList.add("ep-play"))}},{key:"isVolume",value:function(){this.video.muted?(this.video.muted=!1,this.volumeBtn.classList.remove("ep-volume-off"),this.volumeBtn.classList.add("ep-volume-up")):(this.video.muted=!0,this.volumeBtn.classList.remove("ep-volume-up"),this.volumeBtn.classList.add("ep-volume-off"))}},{key:"timeupdate",value:function(){var a,b,c=this.video.currentTime;this.video.buffered.length&&(this.bufferEnd=this.video.buffered.end(this.video.buffered.length-1),this.buffer.style.width=this.bufferEnd/this.video.duration*this.progress.clientWidth+"px"),a=getTimeStr(c),this.currentTime.innerHTML=a,b=c/this.tTime,this.isDown||(this.currentProgress.style.width=b*this.progress.clientWidth+"px",this.dot.style.left=b*this.progress.clientWidth-OFFSETDOT+"px",this.l=b*this.progress.clientWidth)}},{key:"progressClick",value:function(a){var b=a||window.event;this.isDown||(this.video.currentTime=b.offsetX/this.progress.offsetWidth*this.video.duration)}},{key:"volumeClick",value:function(a){var b=a||window.event;this.isDown||(this.vdot.style.left=b.offsetX-OFFSETDOT+"px",this.currentVolumeProgress.style.width=b.offsetX+"px",this.video.volume=b.offsetX/this.volumeProgress.offsetWidth)}},{key:"Dotonmousedown",value:function(a){var b=a||window.event;this.x=b.clientX,this.l=this.l?this.l:b.offsetX,this.isDown=!0}},{key:"Dotonmousemove",value:function(a){if(this.isDown){var b=a||window.event;this.nx=b.clientX,this.nl=this.nx-(this.x-this.l),this.nl<=0&&(this.nl=0),this.nl>=this.progress.clientWidth&&(this.nl=this.progress.clientWidth),this.dot.style.left=this.nl-OFFSETDOT+"px",this.currentProgress.style.width=this.nl+"px",this.x=this.nx,this.l=this.nl}}},{key:"Dotonmouseup",value:function(a){a||window.event,this.video.currentTime=this.nl/this.progress.offsetWidth*this.video.duration,this.isDown=!1}},{key:"Volumeonmousedown",value:function(a){var b=a||window.event;this.vx=b.clientX,this.vl=0!==this.vl?this.vl:b.offsetX,this.isDown=!0}},{key:"Volumeonmousemove",value:function(a){if(this.isDown){var b=a||window.event;this.vnx=b.clientX,this.vnl=this.vnx-(this.vx-this.vl),this.vnl<=0&&(this.vnl=0),this.vnl>=this.volumeProgress.clientWidth&&(this.vnl=this.volumeProgress.clientWidth),this.vdot.style.left=this.vnl-OFFSETDOT+"px",this.currentVolumeProgress.style.width=this.vnl+"px",this.vx=this.vnx,this.vl=this.vnl}}},{key:"Volumeonmouseup",value:function(a){a||window.event,this.isDown=!1,this.video.volume=this.vnl/this.volumeProgress.clientWidth}},{key:"ended",value:function(){this.isPlay.classList.remove("ep-pause"),this.isPlay.classList.add("ep-play"),this.currentProgress.style.width=0,this.dot.style.left=0,this.currentTime.innerHTML=getTimeStr(),this.video.currentTime=0,this.x=this.l=this.nx=this.nl=0,this.isDown=!1}},{key:"fullScreen",value:function(){if(!isFullScreen()){var a=this.el.requestFullScreen||this.el.webkitRequestFullScreen||this.el.mozRequestFullScreen||this.el.msRequestFullscreen;return a.call(this.el)}document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()}},{key:"windowResize",value:function(){isFullScreen()?(this.el.style.height="100%",this.el.style.width="100%"):(this.el.style.height=this.h+"px",this.el.style.width=this.w+"px")}}]),a}(),exports.default=Eplayer;